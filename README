# Heart Track - IoT Heart Rate Monitoring System

A comprehensive IoT-enabled web application for monitoring heart rate and blood oxygen saturation levels. ECE 413/513 Final Project.

## ğŸ‘¥ Team

| Name | Role |
|------|------|
| Zhengxiaohe | Frontend & Backend Developer |
| Zhenyuqi | IoT & Hardware Developer |
| Haotangli | Database & API Developer |

## âœ¨ Features

### Core Features
- **User Authentication** - JWT-based secure registration and login
- **Device Management** - Register and manage multiple Raspberry Pi devices
- **Health Monitoring** - Real-time heart rate and blood oxygen tracking
- **Data Visualization** - Interactive charts with daily/weekly views
- **AI Health Assistant** - LLM-powered chat with RAG for personalized health insights

### Physician Portal (ECE 513)
- Separate physician registration and dashboard
- Patient management and health data viewing
- Measurement frequency adjustment

### IoT Device Features
- Raspberry Pi with MAX30102 sensor
- LED status indicators (Blue/Green/Yellow/Red)
- Offline data storage (up to 24 hours)
- Automatic sync when reconnected

## ğŸ›  Tech Stack

| Layer | Technologies |
|-------|-------------|
| Backend | Node.js, Express.js, MongoDB, JWT |
| Frontend | HTML5, CSS3, JavaScript, Chart.js |
| IoT | Raspberry Pi, MAX30102 Sensor |
| AI | LLM API with RAG |

## ğŸ“ Project Structure

```
heart-track/
â”œâ”€â”€ server.js                 # Main server
â”œâ”€â”€ middleware/
â”‚   â”œâ”€â”€ auth.js              # JWT authentication
â”‚   â””â”€â”€ validation.js        # Request validation
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ User.js              # User model
â”‚   â”œâ”€â”€ Device.js            # Device model
â”‚   â”œâ”€â”€ Measurement.js       # Measurement model
â”‚   â””â”€â”€ Physician.js         # Physician model
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ auth.js              # Auth endpoints
â”‚   â”œâ”€â”€ users.js             # User endpoints
â”‚   â”œâ”€â”€ devices.js           # Device endpoints
â”‚   â”œâ”€â”€ measurements.js      # Measurement endpoints
â”‚   â””â”€â”€ chat.js              # AI chat endpoints
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ index.html           # Landing page
â”‚   â”œâ”€â”€ login.html           # Login page
â”‚   â”œâ”€â”€ register.html        # User registration
â”‚   â”œâ”€â”€ dashboard.html       # User dashboard
â”‚   â”œâ”€â”€ devices.html         # Device management
â”‚   â”œâ”€â”€ profile.html         # User profile
â”‚   â”œâ”€â”€ chat.html            # AI health assistant
â”‚   â”œâ”€â”€ physician-register.html
â”‚   â”œâ”€â”€ physician-dashboard.html
â”‚   â”œâ”€â”€ css/styles.css
â”‚   â””â”€â”€ js/
â”‚       â”œâ”€â”€ main.js          # Shared utilities
â”‚       â”œâ”€â”€ auth.js          # Auth logic
â”‚       â”œâ”€â”€ dashboard.js     # Dashboard logic
â”‚       â”œâ”€â”€ devices.js       # Device logic
â”‚       â”œâ”€â”€ profile.js       # Profile logic
â”‚       â”œâ”€â”€ chat.js          # Chat logic
â”‚       â””â”€â”€ physician-dashboard.js
â””â”€â”€ certs/                    # SSL certificates
```

## ğŸš€ Quick Start

### Prerequisites
- Node.js v14+
- MongoDB v4.4+

### Installation

```bash
# Clone and install
git clone [repo-url]
cd heart-track
npm install

# Configure environment
cp .env.example .env
# Edit .env with your settings

# Start server
npm start
```

### Environment Variables

```env
PORT=3000
MONGODB_URI=mongodb://localhost:27017/hearttrack
JWT_SECRET=your_secret_key
LLM_API_KEY=your_llm_api_key
LLM_API_URL=your_llm_api_url
```

## ğŸ“š API Endpoints

### Authentication
| Method | Endpoint | Description |
|--------|----------|-------------|
| POST | `/api/auth/register` | Register user |
| POST | `/api/auth/login` | Login |
| POST | `/api/auth/physician/register` | Register physician |

### Users
| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/api/users/me` | Get profile |
| PUT | `/api/users/me` | Update profile |
| PUT | `/api/users/me/preferences` | Update preferences |
| GET | `/api/users/physicians` | List physicians |

### Devices
| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/api/devices` | List devices |
| POST | `/api/devices/register` | Register device |
| DELETE | `/api/devices/:id` | Remove device |

### Measurements
| Method | Endpoint | Description |
|--------|----------|-------------|
| POST | `/api/measurements` | Record measurement |
| POST | `/api/measurements/batch` | Batch upload |
| GET | `/api/measurements` | Get measurements |
| GET | `/api/measurements/summary/weekly` | Weekly summary |
| GET | `/api/measurements/daily/:date` | Daily data |

### Chat (AI Assistant)
| Method | Endpoint | Description |
|--------|----------|-------------|
| POST | `/api/chat` | Send message |
| GET | `/api/chat/context` | Get health context |

## ğŸ”§ Hardware Setup

### Components
- Raspberry Pi
- MAX30102 Pulse Oximeter Sensor
- Jumper wires

### Wiring
```
MAX30102    Raspberry Pi
VIN    â†’    3.3V
GND    â†’    GND
SDA    â†’    GPIO 2 (SDA)
SCL    â†’    GPIO 3 (SCL)
```

### LED Indicators
| Color | Status |
|-------|--------|
| Blue | Measurement in progress |
| Green | Data sent successfully |
| Yellow | Stored offline |
| Red | Sensor error |

## ğŸš¢ Deployment

### AWS EC2

```bash
# Install dependencies
sudo apt update
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt install -y nodejs mongodb-org

# Setup application
git clone [repo-url]
cd heart-track
npm install

# Run with PM2
sudo npm install -g pm2
pm2 start server.js --name heart-track
pm2 startup && pm2 save
```

### HTTPS Setup

```bash
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com
```

## ğŸ› Troubleshooting

| Issue | Solution |
|-------|----------|
| MongoDB error | Check `sudo systemctl status mongod` |
| Port in use | `lsof -i :3000` then `kill -9 [PID]` |
| Device not connecting | Verify API key and server URL |
| Sensor not found | Check I2C wiring |

---

**ECE 413/513 Final Project - Fall 2025**
Link: https://zhengxiaohe.duckdns.org:8443/
User Login: haotangli@arizona.edu @Uofa_123456789
Physician Login: zhenyuqi@arizona.edu  @Uofa_123456789
Pitch VIdeo: https://www.youtube.com/watch?v=MfQe6rncOtQ
Demo Video: https://youtu.be/eqh4Rk9r1dY
github Link: https://github.com/miraclehetech/ECE-513
